# 概要
静脈-左房-左室-大動脈のモデルで圧・容量の経時的変化およびPVループを可視化するモデル。

# モデルのUI
UIは以下のパーツで構成する。
- パラメータ設定欄（幅広いスケールに対応できるようにスライダーではなく数値入力形式）
- 各種グラフ
	- 各種グラフはスタートボタンを押すことで経時的にリアルタイムに描かれる。再生速度×10まで設定可能。実際は微小時間ごとに計算を続けているためいずれも点の集合で描かれるべきだが見やすさを重視し点のサイズは最小限とし主に線が見えるようなデザインとする。
	- 心電図（心房収縮、心室収縮・弛緩のタイミングを可視化する）
	- 各種エラスタンス波形（左房と左室）
	- 各種圧波形（大動脈圧、左室圧、左房圧、静脈圧）
	- 僧帽弁と大動脈弁のFlow波形（
	- 左房のPVループ（ESPVRとEDPVRも可視化、左房圧・左房容量に合わせて見やすいようにスケールを手動調整可能とする）
	- 左室のPVループ（ESPVRとEDPVRも可視化、左室圧・左室容量に合わせて見やすいようにスケールを手動調整可能とする）
参考UI画像↓
![[スクリーンショット 2026-01-08 10.42.02.png]]
# 各種計算方法
モデルは以下の構成とする。
静脈リザーバー→左房→(僧帽弁)→左室→(大動脈弁)→大動脈(→末梢動脈)
- 静脈リザーバー→左房間には仮想の抵抗血管を想定し静脈抵抗(Rv)を設定する。静脈リザーバーから左房に流入する血液流量は$(左房圧-静脈圧)/Rv$ で計算する。また、左房-静脈間には弁はないため逆流も可能とする。ただし、逆流により静脈リザーバーの圧は上昇しないものとする。
- 左房
	- 左房収縮
		- タイミングはHRおよび左室収縮からの時間で設定する。PR時間として初期設定は0.15secとする。マイナスの値も許容することで接合部調律時の逆行性伝導による心房収縮も再現可能とする。
		- 収縮力については左室同様にEesを設定し、ESPVRを$P=Ees(V-V_0)$として定義する。
		- **HRに伴う収縮・弛緩時間の変化については後ほど調べて補足する。**
	- 左房のEDPVR
		- 左室同様$P=α(e^β(V-V_0)-1)$で定義する。
- 僧帽弁
	- 弁機能は正常のものとして構築する（後で閉鎖不全、狭窄については機能を追加するかもしれない）
	- 正常弁での左房→左室の流入血液量は$ΔP=R*Q+L*dQ/dt$で表される微分方程式に従う。（ΔP=(左室圧-左房圧)、R：僧帽弁周囲の粘性抵抗、Q：流量、L：慣性定数）
	- ただし正常弁ではΔP<0でQ=0となる。
	- 僧帽弁閉鎖不全症については有効逆流弁口面積の大きさによって逆流量の計算方法を変える必要がある。
	- 僧帽弁狭窄症についてはGorlinの式に従って流量を計算する必要がある。
- 左室
	- 左室収縮
		- タイミングはHRを設定し決める。
		- **収縮様式や収縮ピークまでの時間、能動的弛緩にかかる時間、またこれらがHRによりどう変化するかについては後ほど調べて補足する。**
		- 収縮力については左房同様にEesを設定し、ESPVRを$P=Ees(V-V_0)$として定義する。
	- 左室のEDPVR
		- 左房同様$P=α(e^β(V-V_0)-1)$で定義する。
	- 左室の実効動脈エラスタンスEa
		- 大動脈弁が正常で狭窄がない場合には$Ea=HR*SVR$が成立する。
		- 大動脈弁に狭窄がある場合には上記の式は成立せず、弁狭窄の程度に応じてEaが決まる。
- 大動脈弁
	- 弁機能は正常のものとして構築する（後で閉鎖不全、狭窄については機能を追加するかもしれない）
	- 正常弁での左室→大動脈の流入血液量は$ΔP=R*Q+L*dQ/dt$で表される微分方程式に従う。（ΔP=(左室圧-大動脈圧)、R：大動脈弁周囲の粘性抵抗、Q：流量、L：慣性定数）
	- ただし正常弁ではΔP<0でQ=0となる。
	- 大動脈弁閉鎖不全症については有効逆流弁口面積の大きさによって逆流量の計算方法を変える必要がある。
	- 大動脈弁狭窄症についてはGorlinの式に従って流量を計算する必要がある。
- 大動脈
	- 大動脈圧は$C*dP/dt=Q-P/SVR$で表される微分方程式に従う。（C：大動脈コンプライアンス、P：大動脈圧、Q：流量、SVR：末梢血管抵抗）
- 末梢動脈（可能なら実装）
	- 末梢動脈圧は順行性の波と逆行性の波の合成波として得られる。
	- 末梢血管抵抗の変化で逆行性波の伝播速度は変化し、抵抗が高い方が早く伝播する。
	- **実際の計算式については後ほど調べて補足する。**

# 本シュミレータ作成時の留意事項
- 日本語で回答すること
- 細かい点でも不明瞭な点があれば必ず質問をして解決してから作成を続けること
- 以下のようなphaseに分割して作成し、各phaseでエラーがないかどうか確認した上で次のphaseに進むこと
- 理論について補足する場合にはweb上の資料や以下のパスに存在するpdfファイルを参照すること（ファイルパス：